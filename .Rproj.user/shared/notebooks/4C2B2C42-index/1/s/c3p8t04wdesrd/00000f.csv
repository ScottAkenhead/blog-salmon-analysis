"0","#| label: fig-shifted"
"0","#| fig-cap: ""Salmon counts shifted and scaled (from 0 to 1) by the maximum count, and the corresponding day, within each year."" "
"0",""
"0","peak <-dat$day[ which(dat$count == dat$max)] # peak day by year "
"0","xa <- NULL # temporary"
"0","for(j in 1:4) xa <- c(xa,rep( peak[j], xb[[j]]) )    "
"0","dat$shift <- dat$day - xa "
"0","xa <- dat[order(dat$shift), c(""shift"",""scaled"")] # extract and sort"
"0","# add zeros outside range of obs."
"0","xa0 <- rbind (c(-15,0), xa, c(15,0))"
"0","lo <- loess(scaled ~ shift, data=xa0) # smoother #,span=0.5)"
"0","loPred <- predict(lo, data.frame(shift= -15:15) )"
"0","loPred <-data.frame(pred=loPred,shift=c(-15:15))"
"0","# redo preceding plot"
"0","SetPar()"
"0","plot(scaled~shift,data=xa0, xlim=c(-18,18), ylim=c(0,1), yaxs=""i"","
"0","     xlab='Day from Year Peak', ylab='Scaled Count')"
